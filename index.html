<!DOCTYPE html>
<html lang="fa" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ú¯Ø§Ù‡â€ŒØ´Ù…Ø§Ø±ÛŒ Ø´Ø§Ù‡Ù†Ø´Ø§Ù‡ÛŒ - Imperial Persian Calendar</title>
    <style>
      @import url("https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Vazirmatn:wght@300;400;500;600;700;800&display=swap");

      :root {
        --bg-primary: #0a0a0f;
        --bg-secondary: #111118;
        --bg-tertiary: #1a1a24;
        --accent-primary: #00d4ff;
        --accent-secondary: #7c3aed;
        --accent-gold: #fbbf24;
        --text-primary: #ffffff;
        --text-secondary: #a1a1aa;
        --text-muted: #71717a;
        --border-primary: rgba(255, 255, 255, 0.1);
        --border-accent: rgba(0, 212, 255, 0.3);
        --gradient-primary: linear-gradient(135deg, #00d4ff 0%, #7c3aed 100%);
        --gradient-secondary: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
        --gradient-bg: linear-gradient(
          135deg,
          #0a0a0f 0%,
          #111118 50%,
          #1a1a24 100%
        );
        --shadow-primary: 0 25px 50px -12px rgba(0, 0, 0, 0.8);
        --shadow-accent: 0 0 50px rgba(0, 212, 255, 0.3);
        --blur-bg: blur(20px);
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Inter", "Vazirmatn", -apple-system, BlinkMacSystemFont,
          sans-serif;
        background: var(--gradient-bg);
        color: var(--text-primary);
        line-height: 1.6;
        overflow-x: hidden;
        min-height: 100vh;
      }

      /* Animated background */
      .bg-animation {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: -2;
        background: radial-gradient(
            circle at 20% 20%,
            rgba(0, 212, 255, 0.1) 0%,
            transparent 50%
          ),
          radial-gradient(
            circle at 80% 80%,
            rgba(124, 58, 237, 0.1) 0%,
            transparent 50%
          ),
          radial-gradient(
            circle at 40% 60%,
            rgba(251, 191, 36, 0.05) 0%,
            transparent 50%
          );
        animation: backgroundShift 20s ease-in-out infinite;
      }

      @keyframes backgroundShift {
        0%,
        100% {
          transform: scale(1) rotate(0deg);
        }
        50% {
          transform: scale(1.1) rotate(2deg);
        }
      }

      /* Floating particles */
      .particles {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: -1;
        pointer-events: none;
      }

      .particle {
        position: absolute;
        width: 2px;
        height: 2px;
        background: var(--accent-primary);
        border-radius: 50%;
        animation: float 15s linear infinite;
        opacity: 0.6;
      }

      @keyframes float {
        0% {
          transform: translateY(100vh) translateX(0);
          opacity: 0;
        }
        10% {
          opacity: 0.6;
        }
        90% {
          opacity: 0.6;
        }
        100% {
          transform: translateY(-100px) translateX(100px);
          opacity: 0;
        }
      }

      /* Container */
      .container {
        max-width: 1400px;
        margin: 0 auto;
        padding: 2rem;
      }

      /* Header */
      .header {
        text-align: center;
        margin-bottom: 4rem;
        position: relative;
      }

      .logo {
        width: 80px;
        height: 80px;
        margin: 0 auto 2rem;
        background: var(--gradient-primary);
        border-radius: 20px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 2rem;
        box-shadow: var(--shadow-accent);
        animation: logoFloat 6s ease-in-out infinite;
        position: relative;
        overflow: hidden;
      }

      .logo::before {
        content: "";
        position: absolute;
        top: -50%;
        left: -50%;
        width: 200%;
        height: 200%;
        background: linear-gradient(
          45deg,
          transparent,
          rgba(255, 255, 255, 0.1),
          transparent
        );
        animation: shimmer 3s linear infinite;
      }

      @keyframes logoFloat {
        0%,
        100% {
          transform: translateY(0) rotate(0deg);
        }
        50% {
          transform: translateY(-10px) rotate(5deg);
        }
      }

      @keyframes shimmer {
        0% {
          transform: translateX(-100%) translateY(-100%) rotate(45deg);
        }
        100% {
          transform: translateX(100%) translateY(100%) rotate(45deg);
        }
      }

      .title {
        font-size: clamp(2.5rem, 5vw, 4rem);
        font-weight: 800;
        background: var(--gradient-primary);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        margin-bottom: 1rem;
        letter-spacing: -0.02em;
      }

      .subtitle {
        font-size: 1.25rem;
        color: var(--text-secondary);
        font-weight: 400;
        margin-bottom: 0.5rem;
      }

      .description {
        font-size: 1rem;
        color: var(--text-muted);
        max-width: 600px;
        margin: 0 auto;
      }

      /* Main calendar card */
      .calendar-card {
        background: rgba(255, 255, 255, 0.02);
        backdrop-filter: var(--blur-bg);
        border: 1px solid var(--border-primary);
        border-radius: 24px;
        padding: 3rem;
        margin-bottom: 3rem;
        box-shadow: var(--shadow-primary);
        position: relative;
        overflow: hidden;
      }

      .calendar-card::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 1px;
        background: var(--gradient-primary);
        opacity: 0.5;
      }

      /* Navigation tabs */
      .nav-tabs {
        display: flex;
        gap: 0.5rem;
        margin-bottom: 3rem;
        padding: 0.5rem;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 16px;
        backdrop-filter: var(--blur-bg);
        justify-content: center;
        flex-wrap: wrap;
      }

      .nav-tab {
        background: transparent;
        border: none;
        color: var(--text-secondary);
        padding: 1rem 1.5rem;
        border-radius: 12px;
        cursor: pointer;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        font-family: inherit;
        font-size: 0.95rem;
        font-weight: 500;
        position: relative;
        overflow: hidden;
      }

      .nav-tab::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: var(--gradient-primary);
        opacity: 0;
        transition: opacity 0.3s ease;
        z-index: -1;
      }

      .nav-tab:hover {
        color: var(--text-primary);
        transform: translateY(-2px);
      }

      .nav-tab:hover::before {
        opacity: 0.1;
      }

      .nav-tab.active {
        background: var(--gradient-primary);
        color: var(--text-primary);
        box-shadow: 0 8px 25px rgba(0, 212, 255, 0.3);
      }

      .nav-tab.active::before {
        opacity: 1;
      }

      /* Date display */
      .date-display {
        text-align: center;
        margin-bottom: 3rem;
      }

      .current-date {
        font-size: clamp(2rem, 4vw, 3.5rem);
        font-weight: 700;
        background: var(--gradient-secondary);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        margin-bottom: 1rem;
        line-height: 1.2;
      }

      .date-info {
        font-size: 1.1rem;
        color: var(--text-secondary);
        margin-bottom: 0.5rem;
      }

      .day-name {
        font-size: 1rem;
        color: var(--text-muted);
      }

      /* Info badge */
      .info-badge {
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        background: rgba(251, 191, 36, 0.1);
        border: 1px solid rgba(251, 191, 36, 0.2);
        color: var(--accent-gold);
        padding: 1rem 1.5rem;
        border-radius: 12px;
        font-size: 0.9rem;
        font-weight: 500;
        margin: 2rem 0;
        backdrop-filter: var(--blur-bg);
      }

      /* Converter section */
      .converter {
        background: rgba(255, 255, 255, 0.02);
        backdrop-filter: var(--blur-bg);
        border: 1px solid var(--border-primary);
        border-radius: 24px;
        padding: 3rem;
        box-shadow: var(--shadow-primary);
        position: relative;
        overflow: hidden;
      }

      .converter::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 1px;
        background: var(--gradient-secondary);
        opacity: 0.5;
      }

      .converter-title {
        font-size: 1.75rem;
        font-weight: 700;
        text-align: center;
        margin-bottom: 2rem;
        background: var(--gradient-primary);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }

      /* Input group */
      .input-group {
        display: flex;
        gap: 1rem;
        margin-bottom: 2rem;
        align-items: end;
        justify-content: center;
        flex-wrap: wrap;
      }

      .input-field {
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
      }

      .input-label {
        font-size: 0.875rem;
        color: var(--text-secondary);
        font-weight: 500;
      }

      .input {
        background: rgba(255, 255, 255, 0.05);
        border: 1px solid var(--border-primary);
        color: var(--text-primary);
        padding: 1rem;
        border-radius: 12px;
        font-family: inherit;
        font-size: 1rem;
        width: 100px;
        text-align: center;
        transition: all 0.3s ease;
        backdrop-filter: var(--blur-bg);
      }

      .input:focus {
        outline: none;
        border-color: var(--accent-primary);
        box-shadow: 0 0 0 3px rgba(0, 212, 255, 0.1);
        background: rgba(255, 255, 255, 0.08);
      }

      .select {
        background: rgba(255, 255, 255, 0.05);
        border: 1px solid var(--border-primary);
        color: var(--text-primary);
        padding: 1rem;
        border-radius: 12px;
        font-family: inherit;
        font-size: 1rem;
        width: 180px;
        cursor: pointer;
        backdrop-filter: var(--blur-bg);
        transition: all 0.3s ease;
      }

      .select:focus {
        outline: none;
        border-color: var(--accent-primary);
        box-shadow: 0 0 0 3px rgba(0, 212, 255, 0.1);
      }

      /* Convert button */
      .convert-btn {
        background: var(--gradient-primary);
        border: none;
        color: var(--text-primary);
        padding: 1rem 2rem;
        border-radius: 12px;
        font-family: inherit;
        font-size: 1rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        box-shadow: 0 8px 25px rgba(0, 212, 255, 0.3);
        position: relative;
        overflow: hidden;
      }

      .convert-btn::before {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(
          90deg,
          transparent,
          rgba(255, 255, 255, 0.2),
          transparent
        );
        transition: left 0.5s ease;
      }

      .convert-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 12px 35px rgba(0, 212, 255, 0.4);
      }

      .convert-btn:hover::before {
        left: 100%;
      }

      .convert-btn:active {
        transform: translateY(0);
      }

      /* Results grid */
      .results-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 1.5rem;
        margin-top: 2rem;
      }

      .result-card {
        background: rgba(255, 255, 255, 0.03);
        border: 1px solid var(--border-primary);
        border-radius: 16px;
        padding: 2rem;
        text-align: center;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        backdrop-filter: var(--blur-bg);
        position: relative;
        overflow: hidden;
      }

      .result-card::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: var(--gradient-primary);
        opacity: 0;
        transition: opacity 0.3s ease;
        z-index: -1;
      }

      .result-card:hover {
        transform: translateY(-4px);
        border-color: var(--accent-primary);
        box-shadow: 0 20px 40px rgba(0, 212, 255, 0.2);
      }

      .result-card:hover::before {
        opacity: 0.05;
      }

      .result-title {
        font-size: 0.875rem;
        color: var(--text-secondary);
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.05em;
        margin-bottom: 1rem;
      }

      .result-date {
        font-size: 1.25rem;
        color: var(--text-primary);
        font-weight: 600;
        line-height: 1.4;
      }

      /* Status indicator */
      .status-indicator {
        position: fixed;
        top: 2rem;
        left: 2rem;
        background: rgba(0, 0, 0, 0.8);
        backdrop-filter: var(--blur-bg);
        border: 1px solid var(--border-primary);
        color: var(--text-primary);
        padding: 0.75rem 1rem;
        border-radius: 50px;
        font-size: 0.875rem;
        font-weight: 500;
        z-index: 1000;
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .status-dot {
        width: 8px;
        height: 8px;
        background: var(--accent-primary);
        border-radius: 50%;
        animation: pulse 2s ease-in-out infinite;
      }

      @keyframes pulse {
        0%,
        100% {
          opacity: 1;
        }
        50% {
          opacity: 0.5;
        }
      }

      /* Responsive design */
      @media (max-width: 768px) {
        .container {
          padding: 1rem;
        }
        .calendar-card,
        .converter {
          padding: 2rem;
        }
        .input-group {
          flex-direction: column;
          align-items: center;
        }
        .input,
        .select {
          width: 200px;
        }
        .nav-tabs {
          flex-direction: column;
        }
        .status-indicator {
          position: relative;
          top: 0;
          left: 0;
          margin-bottom: 2rem;
        }
      }

      /* Persian number styling */
      .persian-num {
        font-feature-settings: "tnum";
        font-variant-numeric: tabular-nums;
      }

      /* Loading animation */
      .loading {
        display: inline-block;
        width: 20px;
        height: 20px;
        border: 2px solid var(--border-primary);
        border-radius: 50%;
        border-top-color: var(--accent-primary);
        animation: spin 1s ease-in-out infinite;
      }

      @keyframes spin {
        to {
          transform: rotate(360deg);
        }
      }
    </style>
  </head>
  <body>
    <div class="bg-animation"></div>

    <div class="particles" id="particles"></div>

    <div class="status-indicator">
      <div class="status-dot"></div>
      <span id="statusText">Ú¯Ø§Ù‡â€ŒØ´Ù…Ø§Ø±ÛŒ ÙØ¹Ø§Ù„</span>
    </div>

    <div class="container">
      <header class="header">
        <div class="logo">
          <span>ğŸ‘‘</span>
        </div>
        <h1 class="title">Ú¯Ø§Ù‡â€ŒØ´Ù…Ø§Ø±ÛŒ Ø´Ø§Ù‡Ù†Ø´Ø§Ù‡ÛŒ</h1>
        <p class="subtitle">Imperial Persian Calendar System</p>
        <p class="description">
          Ø³ÛŒØ³ØªÙ… Ù¾ÛŒØ´Ø±ÙØªÙ‡ ØªØ¨Ø¯ÛŒÙ„ Ùˆ Ù†Ù…Ø§ÛŒØ´ ØªØ§Ø±ÛŒØ® Ø¨Ø± Ø§Ø³Ø§Ø³ ØªÙ‚ÙˆÛŒÙ… Ø´Ø§Ù‡Ù†Ø´Ø§Ù‡ÛŒ Ø§ÛŒØ±Ø§Ù† Ø¨Ø§Ø³ØªØ§Ù†
        </p>
      </header>

      <div class="calendar-card">
        <div class="nav-tabs">
          <button class="nav-tab active" onclick="switchCalendar('imperial')">
            Ø´Ø§Ù‡Ù†Ø´Ø§Ù‡ÛŒ
          </button>
          <button class="nav-tab" onclick="switchCalendar('persian')">
            Ø®ÙˆØ±Ø´ÛŒØ¯ÛŒ
          </button>
          <button class="nav-tab" onclick="switchCalendar('hijri')">
            Ù‡Ø¬Ø±ÛŒ Ù‚Ù…Ø±ÛŒ
          </button>
          <button class="nav-tab" onclick="switchCalendar('gregorian')">
            Ù…ÛŒÙ„Ø§Ø¯ÛŒ
          </button>
        </div>

        <div class="date-display">
          <div class="current-date persian-num" id="currentDate">
            <div class="loading"></div>
          </div>
          <div class="date-info" id="dateInfo">Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ...</div>
          <div class="day-name" id="dayName"></div>
        </div>

        <div class="info-badge">
          <span>â„¹ï¸</span>
          <span>ØªÙ‚ÙˆÛŒÙ… Ø´Ø§Ù‡Ù†Ø´Ø§Ù‡ÛŒ Ø­Ø¯ÙˆØ¯ Û±Û±Û¸Û° Ø³Ø§Ù„ Ø§Ø² ØªÙ‚ÙˆÛŒÙ… Ø®ÙˆØ±Ø´ÛŒØ¯ÛŒ Ù¾ÛŒØ´ØªØ± Ø§Ø³Øª</span>
        </div>
      </div>

      <div class="converter">
        <h2 class="converter-title">ØªØ¨Ø¯ÛŒÙ„ ØªØ§Ø±ÛŒØ®</h2>

        <div class="input-group">
          <div class="input-field">
            <label class="input-label">Ø³Ø§Ù„</label>
            <input
              type="number"
              class="input"
              id="inputYear"
              placeholder="1403"
              min="1"
              max="9999"
            />
          </div>
          <div class="input-field">
            <label class="input-label">Ù…Ø§Ù‡</label>
            <input
              type="number"
              class="input"
              id="inputMonth"
              placeholder="12"
              min="1"
              max="12"
            />
          </div>
          <div class="input-field">
            <label class="input-label">Ø±ÙˆØ²</label>
            <input
              type="number"
              class="input"
              id="inputDay"
              placeholder="15"
              min="1"
              max="31"
            />
          </div>
          <div class="input-field">
            <label class="input-label">Ù†ÙˆØ¹ ØªÙ‚ÙˆÛŒÙ…</label>
            <select class="select" id="inputCalendar">
              <option value="imperial">Ø´Ø§Ù‡Ù†Ø´Ø§Ù‡ÛŒ</option>
              <option value="persian">Ø®ÙˆØ±Ø´ÛŒØ¯ÛŒ</option>
              <option value="hijri">Ù‡Ø¬Ø±ÛŒ Ù‚Ù…Ø±ÛŒ</option>
              <option value="gregorian">Ù…ÛŒÙ„Ø§Ø¯ÛŒ</option>
            </select>
          </div>
          <div class="input-field">
            <button class="convert-btn" onclick="convertDate()">ØªØ¨Ø¯ÛŒÙ„</button>
          </div>
        </div>

        <div class="results-grid" id="conversionResults"></div>
      </div>
    </div>

    <script>
      // Persian month names
      const persianMonths = [
        "ÙØ±ÙˆØ±Ø¯ÛŒÙ†",
        "Ø§Ø±Ø¯ÛŒØ¨Ù‡Ø´Øª",
        "Ø®Ø±Ø¯Ø§Ø¯",
        "ØªÛŒØ±",
        "Ù…Ø±Ø¯Ø§Ø¯",
        "Ø´Ù‡Ø±ÛŒÙˆØ±",
        "Ù…Ù‡Ø±",
        "Ø¢Ø¨Ø§Ù†",
        "Ø¢Ø°Ø±",
        "Ø¯ÛŒ",
        "Ø¨Ù‡Ù…Ù†",
        "Ø§Ø³ÙÙ†Ø¯",
      ];

      const hijriMonths = [
        "Ù…Ø­Ø±Ù…",
        "ØµÙØ±",
        "Ø±Ø¨ÛŒØ¹ Ø§Ù„Ø§ÙˆÙ„",
        "Ø±Ø¨ÛŒØ¹ Ø§Ù„Ø«Ø§Ù†ÛŒ",
        "Ø¬Ù…Ø§Ø¯ÛŒ Ø§Ù„Ø§ÙˆÙ„",
        "Ø¬Ù…Ø§Ø¯ÛŒ Ø§Ù„Ø«Ø§Ù†ÛŒ",
        "Ø±Ø¬Ø¨",
        "Ø´Ø¹Ø¨Ø§Ù†",
        "Ø±Ù…Ø¶Ø§Ù†",
        "Ø´ÙˆØ§Ù„",
        "Ø°ÛŒ Ø§Ù„Ù‚Ø¹Ø¯Ù‡",
        "Ø°ÛŒ Ø§Ù„Ø­Ø¬Ù‡",
      ];

      const gregorianMonths = [
        "Ú˜Ø§Ù†ÙˆÛŒÙ‡",
        "ÙÙˆØ±ÛŒÙ‡",
        "Ù…Ø§Ø±Ø³",
        "Ø¢Ù¾Ø±ÛŒÙ„",
        "Ù…Ù‡",
        "Ú˜ÙˆØ¦Ù†",
        "Ú˜ÙˆØ¦ÛŒÙ‡",
        "Ø§ÙˆØª",
        "Ø³Ù¾ØªØ§Ù…Ø¨Ø±",
        "Ø§Ú©ØªØ¨Ø±",
        "Ù†ÙˆØ§Ù…Ø¨Ø±",
        "Ø¯Ø³Ø§Ù…Ø¨Ø±",
      ];

      const persianDays = [
        "Ø´Ù†Ø¨Ù‡",
        "ÛŒÚ©Ø´Ù†Ø¨Ù‡",
        "Ø¯ÙˆØ´Ù†Ø¨Ù‡",
        "Ø³Ù‡â€ŒØ´Ù†Ø¨Ù‡",
        "Ú†Ù‡Ø§Ø±Ø´Ù†Ø¨Ù‡",
        "Ù¾Ù†Ø¬â€ŒØ´Ù†Ø¨Ù‡",
        "Ø¬Ù…Ø¹Ù‡",
      ];

      let currentCalendar = "imperial";
      const IMPERIAL_EPOCH_DIFFERENCE = 1180;

      // Create floating particles
      function createParticles() {
        const particlesContainer = document.getElementById("particles");
        for (let i = 0; i < 50; i++) {
          const particle = document.createElement("div");
          particle.className = "particle";
          particle.style.left = Math.random() * 100 + "%";
          particle.style.animationDelay = Math.random() * 15 + "s";
          particle.style.animationDuration = Math.random() * 10 + 10 + "s";
          particlesContainer.appendChild(particle);
        }
      }

      // Convert to Persian numerals
      function toPersianNum(num) {
        const persianDigits = "Û°Û±Û²Û³Û´ÛµÛ¶Û·Û¸Û¹";
        return num.toString().replace(/\d/g, (digit) => persianDigits[digit]);
      }

      // Calendar conversion functions (same logic as before)
      function gregorianToPersian(gYear, gMonth, gDay) {
        let pYear = gYear - 621;
        if (gMonth < 3 || (gMonth === 3 && gDay < 21)) {
          pYear--;
        }

        let pMonth, pDay;
        const springStart = new Date(gYear, 2, 21);
        const currentDate = new Date(gYear, gMonth - 1, gDay);
        const dayOfYear = Math.floor(
          (currentDate - springStart) / (1000 * 60 * 60 * 24)
        );

        if (dayOfYear < 0) {
          pYear--;
          const prevSpringStart = new Date(gYear - 1, 2, 21);
          const adjustedDayOfYear = Math.floor(
            (currentDate - prevSpringStart) / (1000 * 60 * 60 * 24)
          );
          [pMonth, pDay] = dayOfYearToPersianMonthDay(adjustedDayOfYear);
        } else {
          [pMonth, pDay] = dayOfYearToPersianMonthDay(dayOfYear);
        }

        return { year: pYear, month: pMonth, day: pDay };
      }

      function dayOfYearToPersianMonthDay(dayOfYear) {
        if (dayOfYear < 186) {
          const month = Math.floor(dayOfYear / 31) + 1;
          const day = (dayOfYear % 31) + 1;
          return [Math.min(month, 6), day];
        } else {
          const remainingDays = dayOfYear - 186;
          const month = Math.floor(remainingDays / 30) + 7;
          const day = (remainingDays % 30) + 1;
          return [Math.min(month, 12), Math.min(day, month === 12 ? 29 : 30)];
        }
      }

      function persianToGregorian(pYear, pMonth, pDay) {
        const gYear = pYear + 621;
        let dayOfYear = 0;
        if (pMonth <= 6) {
          dayOfYear = (pMonth - 1) * 31 + pDay - 1;
        } else {
          dayOfYear = 186 + (pMonth - 7) * 30 + pDay - 1;
        }

        const nowruz = new Date(gYear, 2, 21);
        const targetDate = new Date(
          nowruz.getTime() + dayOfYear * 24 * 60 * 60 * 1000
        );

        return {
          year: targetDate.getFullYear(),
          month: targetDate.getMonth() + 1,
          day: targetDate.getDate(),
        };
      }

      function persianToImperial(pYear, pMonth, pDay) {
        return {
          year: pYear + IMPERIAL_EPOCH_DIFFERENCE,
          month: pMonth,
          day: pDay,
        };
      }

      function imperialToPersian(iYear, iMonth, iDay) {
        return {
          year: iYear - IMPERIAL_EPOCH_DIFFERENCE,
          month: iMonth,
          day: iDay,
        };
      }

      function gregorianToImperial(gYear, gMonth, gDay) {
        const persian = gregorianToPersian(gYear, gMonth, gDay);
        return persianToImperial(persian.year, persian.month, persian.day);
      }

      function imperialToGregorian(iYear, iMonth, iDay) {
        const persian = imperialToPersian(iYear, iMonth, iDay);
        return persianToGregorian(persian.year, persian.month, persian.day);
      }

      function gregorianToHijri(gYear, gMonth, gDay) {
        const totalDays = Math.floor(
          (new Date(gYear, gMonth - 1, gDay) - new Date(622, 6, 16)) /
            (1000 * 60 * 60 * 24)
        );
        const hYear = Math.floor(totalDays / 354.367) + 1;
        const remainingDays = totalDays - Math.floor((hYear - 1) * 354.367);

        let hMonth = 1;
        let hDay = remainingDays;
        const monthDays = [30, 29, 30, 29, 30, 29, 30, 29, 30, 29, 30, 29];

        for (let i = 0; i < 12; i++) {
          if (hDay <= monthDays[i]) {
            hMonth = i + 1;
            break;
          }
          hDay -= monthDays[i];
        }

        return {
          year: Math.max(1, hYear),
          month: hMonth,
          day: Math.max(1, hDay),
        };
      }

      function hijriToGregorian(hYear, hMonth, hDay) {
        const totalDays =
          Math.floor((hYear - 1) * 354.367) +
          [0, 30, 59, 89, 118, 148, 177, 207, 236, 266, 295, 325][hMonth - 1] +
          hDay -
          1;

        const hijriEpoch = new Date(622, 6, 16);
        const gDate = new Date(
          hijriEpoch.getTime() + totalDays * 24 * 60 * 60 * 1000
        );

        return {
          year: gDate.getFullYear(),
          month: gDate.getMonth() + 1,
          day: gDate.getDate(),
        };
      }

      function getCurrentDate() {
        const now = new Date();
        const gDate = {
          year: now.getFullYear(),
          month: now.getMonth() + 1,
          day: now.getDate(),
        };

        const pDate = gregorianToPersian(gDate.year, gDate.month, gDate.day);
        const iDate = persianToImperial(pDate.year, pDate.month, pDate.day);
        const hDate = gregorianToHijri(gDate.year, gDate.month, gDate.day);

        return {
          gregorian: gDate,
          persian: pDate,
          imperial: iDate,
          hijri: hDate,
        };
      }

      function formatDate(date, calendar) {
        const months =
          calendar === "persian" || calendar === "imperial"
            ? persianMonths
            : calendar === "hijri"
            ? hijriMonths
            : gregorianMonths;

        return `${toPersianNum(date.day)} ${
          months[date.month - 1]
        } ${toPersianNum(date.year)}`;
      }

      function getPersianDayName() {
        const now = new Date();
        return persianDays[now.getDay()];
      }

      function updateDisplay() {
        try {
          const dates = getCurrentDate();
          const currentDateData = dates[currentCalendar];

          document.getElementById("currentDate").textContent = formatDate(
            currentDateData,
            currentCalendar
          );
          document.getElementById("dayName").textContent = getPersianDayName();

          const calendarNames = {
            imperial: "ØªÙ‚ÙˆÛŒÙ… Ø´Ø§Ù‡Ù†Ø´Ø§Ù‡ÛŒ (Ø§Ø² ØªØ£Ø³ÛŒØ³ Ø§Ù…Ù¾Ø±Ø§ØªÙˆØ±ÛŒ Ù‡Ø®Ø§Ù…Ù†Ø´ÛŒ)",
            persian: "ØªÙ‚ÙˆÛŒÙ… Ø®ÙˆØ±Ø´ÛŒØ¯ÛŒ",
            hijri: "ØªÙ‚ÙˆÛŒÙ… Ù‡Ø¬Ø±ÛŒ Ù‚Ù…Ø±ÛŒ",
            gregorian: "ØªÙ‚ÙˆÛŒÙ… Ù…ÛŒÙ„Ø§Ø¯ÛŒ",
          };

          document.getElementById("dateInfo").textContent =
            calendarNames[currentCalendar];

          // Update status
          const statusIcons = {
            imperial: "ğŸ‘‘",
            persian: "â˜€ï¸",
            hijri: "ğŸŒ™",
            gregorian: "ğŸŒ",
          };
          document.getElementById(
            "statusText"
          ).textContent = `${statusIcons[currentCalendar]} ${calendarNames[currentCalendar]}`;
        } catch (error) {
          console.error("Error updating display:", error);
          document.getElementById("currentDate").textContent =
            "Ø®Ø·Ø§ Ø¯Ø± Ù†Ù…Ø§ÛŒØ´ ØªØ§Ø±ÛŒØ®";
        }
      }

      function switchCalendar(calendar) {
        currentCalendar = calendar;

        document.querySelectorAll(".nav-tab").forEach((btn) => {
          btn.classList.remove("active");
        });
        event.target.classList.add("active");

        updateDisplay();
      }

      function convertDate() {
        const year = parseInt(document.getElementById("inputYear").value);
        const month = parseInt(document.getElementById("inputMonth").value);
        const day = parseInt(document.getElementById("inputDay").value);
        const inputCalendar = document.getElementById("inputCalendar").value;

        if (!year || !month || !day) {
          alert("Ù„Ø·ÙØ§Ù‹ ØªÙ…Ø§Ù… ÙÛŒÙ„Ø¯Ù‡Ø§ Ø±Ø§ Ù¾Ø± Ú©Ù†ÛŒØ¯");
          return;
        }

        try {
          let results = {};

          if (inputCalendar === "imperial") {
            const pDate = imperialToPersian(year, month, day);
            const gDate = persianToGregorian(
              pDate.year,
              pDate.month,
              pDate.day
            );
            const hDate = gregorianToHijri(gDate.year, gDate.month, gDate.day);
            results = {
              imperial: { year, month, day },
              persian: pDate,
              gregorian: gDate,
              hijri: hDate,
            };
          } else if (inputCalendar === "persian") {
            const iDate = persianToImperial(year, month, day);
            const gDate = persianToGregorian(year, month, day);
            const hDate = gregorianToHijri(gDate.year, gDate.month, gDate.day);
            results = {
              persian: { year, month, day },
              imperial: iDate,
              gregorian: gDate,
              hijri: hDate,
            };
          } else if (inputCalendar === "hijri") {
            const gDate = hijriToGregorian(year, month, day);
            const pDate = gregorianToPersian(
              gDate.year,
              gDate.month,
              gDate.day
            );
            const iDate = persianToImperial(pDate.year, pDate.month, pDate.day);
            results = {
              hijri: { year, month, day },
              gregorian: gDate,
              persian: pDate,
              imperial: iDate,
            };
          } else {
            const pDate = gregorianToPersian(year, month, day);
            const iDate = persianToImperial(pDate.year, pDate.month, pDate.day);
            const hDate = gregorianToHijri(year, month, day);
            results = {
              gregorian: { year, month, day },
              persian: pDate,
              imperial: iDate,
              hijri: hDate,
            };
          }

          displayResults(results);
        } catch (error) {
          alert("Ø®Ø·Ø§ Ø¯Ø± ØªØ¨Ø¯ÛŒÙ„ ØªØ§Ø±ÛŒØ®");
          console.error("Conversion error:", error);
        }
      }

      function displayResults(results) {
        const container = document.getElementById("conversionResults");
        container.innerHTML = "";

        const titles = {
          imperial: "Ø´Ø§Ù‡Ù†Ø´Ø§Ù‡ÛŒ",
          persian: "Ø®ÙˆØ±Ø´ÛŒØ¯ÛŒ",
          hijri: "Ù‡Ø¬Ø±ÛŒ Ù‚Ù…Ø±ÛŒ",
          gregorian: "Ù…ÛŒÙ„Ø§Ø¯ÛŒ",
        };

        Object.keys(results).forEach((calendar) => {
          const card = document.createElement("div");
          card.className = "result-card";

          card.innerHTML = `
                    <div class="result-title">${titles[calendar]}</div>
                    <div class="result-date persian-num">${formatDate(
                      results[calendar],
                      calendar
                    )}</div>
                `;

          container.appendChild(card);
        });
      }

      // Initialize
      document.addEventListener("DOMContentLoaded", function () {
        createParticles();
        updateDisplay();
        setInterval(updateDisplay, 60000);
      });

      setTimeout(updateDisplay, 100);
    </script>
  </body>
</html>
